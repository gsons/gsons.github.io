var app=angular.module("app",["ionic","ngStorage","ionicLazyLoad"]);app.config(["$ionicConfigProvider","$sceDelegateProvider",function(e,t){e.scrolling.jsScrolling(!1),e.platform.ios.tabs.style("standard"),e.platform.ios.tabs.position("bottom"),e.platform.android.tabs.style("standard"),e.platform.android.spinner.icon("ios"),e.platform.android.tabs.position("standard"),e.platform.ios.navBar.alignTitle("center"),e.platform.android.navBar.alignTitle("bottom"),e.platform.ios.views.transition("ios"),e.platform.android.views.transition("android")}]),app.config(["$httpProvider",function(e){e.interceptors.push("AuthInterceptor")}]),app.factory("AuthInterceptor",["$rootScope","$q","$location","$timeout","$window",function(e,t,o,n,i){return{response:function(e,t){o.path(),e.headers();return e}}}]),app.run(["$ionicViewSwitcher","$window","$rootScope","$state","$stateParams","$localStorage","$http","$q","$location",function(e,t,r,o,n,i,a,c,s){r.$state=o,r.$stateParams=n,r.$goback=function(){t.history.back(),e.nextDirection("back")},r.$refresh=function(){t.location.reload()},r.$search=function(){o.go("search"),e.nextDirection("forward")},r.$on("$stateChangeSuccess",function(e,t,o,n,i,a){r.previousState=n,r.previousStateParams=i}),r.$on("$stateChangeStart",function(e,t,o,n,i){})}]),app.constant("WAP_CONFIG",{host:"https://api.avgle.com",port:443,path:"/v1/",platform:"browser"}),app.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/app",templateUrl:"tpl/app.html?v="+$tplVersion,abstract:!0}).state("app.home",{url:"/home",views:{"tab-home":{templateUrl:"tpl/home.html?v="+$tplVersion,controller:"homeCtrl",cache:!0}}}).state("app.list",{url:"/list",views:{"tab-list":{templateUrl:"tpl/list.html?v="+$tplVersion,controller:"listCtrl",cache:!0}}}).state("app.person",{url:"/person",views:{"tab-person":{templateUrl:"tpl/person.html?v="+$tplVersion,controller:"personCtrl",cache:!0}}}).state("view",{url:"/view",templateUrl:"tpl/view.html?v="+$tplVersion,controller:"viewCtrl",cache:!0}).state("star",{url:"/star",templateUrl:"tpl/star.html?v="+$tplVersion,controller:"starCtrl",cache:!0}).state("demo",{url:"/demo",templateUrl:"tpl/demo.html?v="+$tplVersion,controller:"demoCtrl",cache:!0}).state("search",{url:"/search?key",templateUrl:"tpl/search.html?v="+$tplVersion,controller:"searchCtrl",cache:!0}),t.otherwise("/app/home")}]),app.directive("ionImg",function(){return{scope:{ngsrc:"@",ngopt:"@"},link:function(e,t){var o=e.ngsrc,n=e.ngopt,i=angular.element(t)[0];if(i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAnCAIAAAADwcZiAAAAW0lEQVRYCe3SMQ7AMAzDwLb//6k/UWTnyGQJPWqQgIPfmXmO33d8cQ22ups94YQ9gb7Js+SmhNnFSxP2LLkpYXbx0oQ9S25KmF28NGHPkpsSZhcvTdiz5KabhH9OFAMPqToRyQAAAABJRU5ErkJggg==",n){var a=(n=n.split(","))[0],r=n[1];i.width=screen.width+parseInt(a),i.height=i.width*r}var c=new Image;c.src=o,c.onload=function(){i.src=o}}}}),app.directive("ionInput",["$compile",function(a){return{restrict:"AE",replace:!1,scope:{model:"="},link:function(e,t,o,n){e.data=1,e.show=function(){e.data++};var i=a("<input type='number' ng-model='data'> <button ng-click='show()'>show</button>")(e);t.append(i)}}}]),app.directive("rjHoldActive",["$timeout",function(i){return{restrict:"AE",replace:!1,link:function(e,t,o,n){t.bind("click",function(e){var t=document.getElementById("ripple");t.classList?t.classList.add("animate"):t.className+=" animate",t.style.left=e.pageX-20+"px",t.style.top=e.pageY-20+"px",i(function(){t.style.left="-40px",t.style.top="-40px",t.classList?t.classList.remove("animate"):t.className=t.className.replace("animate","")},200)})}}}]),app.directive("ionMovie",["$confirm","$state","$localStorage","Toast","$ionicViewSwitcher","$ionicListDelegate","$rootScope",function(i,a,r,c,s,l,e){return{restrict:"AE",replace:!1,scope:!1,priority:1001,templateUrl:"tpl/component.html",link:function(t,e,o,n){t.btnOption=t.btnOption||1,t.viewOption=t.viewOption||1,t.view=function(e){1==t.viewOption?t.view1(e):2==t.viewOption&&t.view2(e)},t.view1=function(e){r.video=e,a.go("view"),s.nextDirection("forward")},t.save=function(e){var t=r.saveList||[],o=!1;for(var n in t)if(t[n].vid==e.vid){o=!0;break}o?c.show("您已经收藏了该电影"):t.unshift(e),r.saveList=t,l.closeOptionButtons()},t.view2=function(e){r.video=e,a.go("view",{},{reload:!0})},t.delete=function(e){i.show({title:"确定要删除吗"},function(){$scope.videos.splice(e,1),r.saveList=$scope.videos,l.closeOptionButtons()},function(){l.closeOptionButtons()})}}}}]),app.directive("labelKeyword",["$compile",function(e){return{restrict:"AE",replace:!1,priority:1001,scope:{keywords:"@"},template:'<button ng-repeat="vo in keywordArr" class="button-assertive button button-small btn-keyword" ng-click="$event.stopPropagation()" ui-sref="search({key:vo})">{{vo}}</button>',link:function(e,t,o,n){e.keywordArr=e.keywords.split(" ")}}}]),angular.module("ionicLazyLoad",[]),angular.module("ionicLazyLoad").directive("lazyScroll",["$rootScope",function(o){return{restrict:"A",link:function(e){var t=e.$onScroll;e.$onScroll=function(){o.$broadcast("lazyScrollEvent"),"function"==typeof t&&t()}}}}]).directive("imageLazySrc",["$document","$timeout","$ionicScrollDelegate","$compile",function(l,p,t,d){return{restrict:"A",scope:{lazyScrollResize:"@lazyScrollResize",imageLazyBackgroundImage:"@imageLazyBackgroundImage",imageLazySrc:"@"},link:function(n,i,a){var r;a.imageLazyDistanceFromBottomToLoad||(a.imageLazyDistanceFromBottomToLoad=0),a.imageLazyDistanceFromRightToLoad||(a.imageLazyDistanceFromRightToLoad=0),a.imageLazyLoader&&(r=d('<div class="image-loader-container"><ion-spinner class="image-loader" icon="'+a.imageLazyLoader+'"></ion-spinner></div>')(n),i.after(r)),n.$watch("imageLazySrc",function(e,t){r&&r.remove(),a.imageLazyLoader&&(r=d('<div class="image-loader-container"><ion-spinner class="image-loader" icon="'+a.imageLazyLoader+'"></ion-spinner></div>')(n),i.after(r));var o=n.$on("lazyScrollEvent",function(){s()&&(c(),o())});p(function(){s()&&(c(),o())},500)});var e=n.$on("lazyScrollEvent",function(){s()&&(c(),e())});function c(){if(i.bind("load",function(e){a.imageLazyLoader&&r.remove(),"true"==n.lazyScrollResize&&t.resize(),i.unbind("load")}),i.bind("error",function(e){this.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAnCAIAAAADwcZiAAAAW0lEQVRYCe3SMQ7AMAzDwLb//6k/UWTnyGQJPWqQgIPfmXmO33d8cQ22ups94YQ9gb7Js+SmhNnFSxP2LLkpYXbx0oQ9S25KmF28NGHPkpsSZhcvTdiz5KabhH9OFAMPqToRyQAAAABJRU5ErkJggg=="}),"true"==n.imageLazyBackgroundImage){var e=new Image;e.onload=function(){a.imageLazyLoader&&r.remove(),i[0].style.backgroundImage="url("+a.imageLazySrc+")","true"==n.lazyScrollResize&&t.resize()},e.src=a.imageLazySrc}else i[0].src=a.imageLazySrc}function s(){var e=l[0].documentElement.clientHeight,t=l[0].documentElement.clientWidth,o=i[0].getBoundingClientRect();return 0<=o.top&&o.top<=e+parseInt(a.imageLazyDistanceFromBottomToLoad)&&0<=o.left&&o.left<=t+parseInt(a.imageLazyDistanceFromRightToLoad)}i.on("$destroy",function(){e()}),p(function(){s()&&(c(),e())},500)}}}]),function(){function e(s){return["$rootScope","$window",function(t,e){for(var o,n,i,a=e[s]||(console.warn("This browser does not support Web Storage!"),{}),r={$default:function(e){for(var t in e)angular.isDefined(r[t])||(r[t]=e[t]);return r},$reset:function(e){for(var t in r)"$"===t[0]||delete r[t];return r.$default(e)}},c=0;c<a.length;c++)(i=a.key(c))&&"ngStorage-"===i.slice(0,10)&&(r[i.slice(10)]=angular.fromJson(a.getItem(i)));return o=angular.copy(r),t.$watch(function(){n||(n=setTimeout(function(){if(n=null,!angular.equals(r,o)){for(var e in angular.forEach(r,function(e,t){angular.isDefined(e)&&"$"!==t[0]&&a.setItem("ngStorage-"+t,angular.toJson(e)),delete o[t]}),o)a.removeItem("ngStorage-"+e);o=angular.copy(r)}},100))}),"localStorage"===s&&e.addEventListener&&e.addEventListener("storage",function(e){"ngStorage-"===e.key.slice(0,10)&&(e.newValue?r[e.key.slice(10)]=angular.fromJson(e.newValue):delete r[e.key.slice(10)],o=angular.copy(r),t.$apply())}),r}]}angular.module("ngStorage",[]).factory("$localStorage",e("localStorage")).factory("$sessionStorage",e("sessionStorage"))}(),app.factory("$loading",["$ionicLoading",function(l){return{show:function(e,t,o,n){var i=e||!1,a=o||"ios",r=n||"",c=t||"",s=i?"<style>.loading-container .loading{background-color: rgba(0, 0, 0,0.6);}</style>":"<style>.loading-container .loading{background-color: rgba(0, 0, 0,0.2);}</style>";l.show({template:s+'<ion-spinner icon="'+a+'" class="'+r+'"></ion-spinner><div>'+c+"</div>",content:"Loading",animation:"",showBackdrop:i,minWidth:500,showDelay:0})},hide:function(){l.hide()}}}]),app.factory("$confirm",["$ionicPopup",function(c){return{show:function(e,t,o){var n=e.title||"提示",i=e.content||"",a=t||function(){},r=o||function(){};c.confirm({template:i,title:n,buttons:[{text:"确定",type:"button-positive",onTap:function(e){return 1}},{text:"取消",type:"button-assertive"}]}).then(function(e){e?a():r()})}}}]),app.filter("Datetranslater",function(){return function(e){var t=e,o=new Date(t),n=(new Date).getTime();return o.toDateString()===(new Date).toDateString()?i(o,"HH:mm"):n-t<5184e5?i(o,"w HH:mm"):o.getMonth()==(new Date).getMonth()&&o.getFullYear()==(new Date).getFullYear()?i(o,"MM-dd HH:mm"):(o.getFullYear(),(new Date).getFullYear(),i(o,"yyyy-MM-dd HH:mm"))};function i(e,t){t=t||"yyyy-MM-dd HH:mm:ss";var i={y:(e="number"==typeof(e=null==e?new Date:e)?new Date(e):e).getFullYear(),M:e.getMonth()+1,d:e.getDate(),q:Math.floor((e.getMonth()+3)/3),w:e.getDay(),H:e.getHours(),h:e.getHours()%12==0?12:e.getHours()%12,m:e.getMinutes(),s:e.getSeconds(),S:e.getMilliseconds()},a=["日","一","二","三","四","五","六"];for(var r in i)t=t.replace(new RegExp(r+"+","g"),function(e){var t=i[r]+"";if("w"==r)return(2<e.length?"星期":"周")+a[t];for(var o=0,n=t.length;o<e.length-n;o++)t="0"+t;return 1==e.length?t:t.substring(t.length-e.length)});return t}}),app.factory("Api",["$http","WAP_CONFIG","$q","$log","$ionicLoading","$timeout",function(o,e,n,a,r,c){var t=e,s=t.host+":"+t.port+t.path;return{endpoint:s,post:function(e,t){e=s+e;var i=n.defer();return r.show({template:"加载中..."}),(null!=t&&null!=t&&""!=t?o.post(e,t,{timeout:5e3}):o.post(e,{timeout:5e3})).success(function(e,t,o,n){i.resolve(e),r.hide()}).error(function(e,t){i.reject(e),a.error(e,t),r.hide(),r.show({template:"出错了..."}),c(function(){r.hide()},1e3)}),i.promise},get:function(e,t){e=s+e;var i=n.defer();return r.show({template:"加载中..."}),(null!=t&&null!=t&&""!=t?o.get(e,t,{timeout:5e3}):o.get(e,{timeout:5e3})).success(function(e,t,o,n){i.resolve(e),r.hide()}).error(function(e,t){i.reject(e),r.hide(),a.error(e,t),r.show({template:'<i class="icon ion-android-warning assertive"></i> 出错了'}),c(function(){r.hide()},1e3)}),i.promise}}}]),app.factory("Toast",["$timeout","$ionicLoading",function(i,a){return{show:function(e,t){var o=t||"info";if("error"==o)var n="icon ion-android-alert assertive";else if("success"==o)n="icon ion-android-alert positive";else if("info"==o)n="icon ion-android-alert calm";a.show({template:'<i class="'+n+'">  '+e+"</i>"}),i(function(){a.hide()},1500)}}}]),app.filter("keyWord",function(){return function(e){var t=e.split(" "),o=e.split(",");return t[0]||o[0]||" "}}),app.controller("demoCtrl",["Api","$rootScope","$location","$ionicScrollDelegate","$loading","$scope","$http","$sessionStorage","$localStorage",function(e,t,o,n,i,a,r,c,s){a.toggleShow=function(e){if(!(e>=a.categories.length)){a.showItem=e;var t=document.getElementById("tab-cate-"+e),o=t.offsetLeft+t.offsetWidth-document.body.clientWidth/2;n.$getByHandle("slideScroll").scrollTo(o,0,!0)}},a.showItem=0,e.get("categories").then(function(e){e.success&&(a.categories=e.response.categories,a.categoryId="1")})}]),app.controller("homeCtrl",["$timeout","$scope","Api","$ionicScrollDelegate",function(o,r,c,s){function e(){var e,t,o,n,i,a;r.page=0,r.has_more=!0,r.videos=[],r.position="",n=e||"mr",i=t||1,a=o||5,c.get("videos/"+i+"?o="+n+"&limit="+a).then(function(e){e.success&&(r.slideVideos=e.response.videos)})}r.allVideo=function(e,t,o){var n=e||"mv",i=t||1;1==i&&(r.searchKey="",r.page=1,r.videos=[],s.$getByHandle("homeScroll").scrollTop(!0));var a=o||10;c.get("videos/"+i+"?o="+n+"&limit="+a).then(function(e){e.success&&(r.has_more=e.response.has_more,r.videos=r.videos.concat(e.response.videos),r.$broadcast("scroll.infiniteScrollComplete"))})},r.loadNextPage=function(){r.page++,r.allVideo("mv",r.page)},r.$on("$ionicView.loaded",function(){console.log("home","$ionicView.loaded"),e()}),r.$on("$ionicView.beforeEnter",function(e){r.isBtnTop=!1,console.log("star","$ionicView.beforeEnter")}),r.scroll=function(){600<s.$getByHandle("homeScroll").getScrollPosition().top?o(function(){r.isBtnTop=!0},300):o(function(){r.isBtnTop=!1},300)},r.scrollTop=function(e){var t=e.target;t.classList?t.classList.add("activated"):t.className+=" activated",o(function(){t.classList?t.classList.remove("activated"):t.className=t.className.replace("activated","")},300),s.$getByHandle("homeScroll").scrollTop(!0)}}]),app.controller("listCtrl",["$timeout","$scope","Api","$ionicScrollDelegate",function(o,a,r,n){function e(){a.categoryId="1",a.videos=[],a.has_more=!0,r.get("categories").then(function(e){e.success&&(a.categories=e.response.categories,a.categoryId="1")}),a.isBtnTop=!1}a.getVideoByCHID=function(e,t,o){a.categoryId=e,a.has_more=!0;var n=t||1;1==n&&(a.page=1,a.videos=[]);var i=o||10;r.get("videos/"+n+"?c="+e+"&limit="+i).then(function(e){e.success&&(a.$broadcast("scroll.infiniteScrollComplete"),a.has_more=e.response.has_more,a.videos=a.videos.concat(e.response.videos))})},a.loadNextPage=function(){a.page++,a.getVideoByCHID(a.categoryId,a.page)},a.change=function(e){a.getVideoByCHID(e)},a.$on("$ionicView.loaded",function(){console.log("list","$ionicView.loaded"),e()}),a.scroll=function(){600<n.$getByHandle("listScroll").getScrollPosition().top?o(function(){a.isBtnTop=!0},300):o(function(){a.isBtnTop=!1},300)},a.scrollTop=function(e){var t=e.target;t.classList?t.classList.add("activated"):t.className+=" activated",o(function(){t.classList?t.classList.remove("activated"):t.className=t.className.replace("activated","")},300),n.$getByHandle("listScroll").scrollTop(!0)}}]),app.controller("personCtrl",["$state","$scope","$ionicViewSwitcher",function(e,t,o){t.$on("$ionicView.loaded",function(){console.log("person","$ionicView.loaded")}),t.goStar=function(){e.go("star"),o.nextDirection("forward")}}]),app.controller("searchCtrl",["$timeout","Api","$location","$ionicScrollDelegate","$scope",function(o,c,s,l,p){p.searchVideo=function(e,t,o){var n=t||1;1==n&&(p.page=1,p.videos=[],l.$getByHandle("searchScroll").scrollTop(!0));var i=e||"";if(i){var a=o||15,r=s.search().key==p.searchKey?"jav":"search";c.get(r+"/"+encodeURIComponent(i)+"/"+n+"?limit="+a).then(function(e){e.success&&(p.has_more=e.response.has_more,p.videos=p.videos.concat(e.response.videos),p.$broadcast("scroll.infiniteScrollComplete"))})}},p.submit=function(e){l.$getByHandle("searchScroll").scrollTop(!0),p.searchVideo(e)},p.loadNextPage=function(e){p.page++,p.searchVideo(e,p.page)},p.$on("$ionicView.enter",function(e){!function(){p.searchKey=s.search().key,p.searchKey&&(p.has_more=!0);document.getElementById("input_key").focus()}(),console.log("search","$ionicView.enter")}),p.scroll=function(){600<l.$getByHandle("searchScroll").getScrollPosition().top?o(function(){p.isBtnTop=!0},300):o(function(){p.isBtnTop=!1},300)},p.scrollTop=function(e){var t=e.target;t.classList?t.classList.add("activated"):t.className+=" activated",o(function(){t.classList?t.classList.remove("activated"):t.className=t.className.replace("activated","")},300),l.$getByHandle("searchScroll").scrollTop(!0)},p.search=function(e){p.searchKey=e,p.searchVideo(e)}}]),app.controller("starCtrl",["$timeout","$ionicScrollDelegate","$scope","$localStorage",function(o,n,t,i){t.$on("$ionicView.enter",function(e){t.videos=i.saveList,console.log("star","$ionicView.enter")}),t.scroll=function(){500<n.$getByHandle("starScroll").getScrollPosition().top?o(function(){t.isBtnTop=!0},600):o(function(){t.isBtnTop=!1},600)},t.scrollTop=function(e){var t=e.target;t.classList?t.classList.add("activated"):t.className+=" activated",o(function(){t.classList?t.classList.remove("activated"):t.className=t.className.replace("activated","")},600),n.$getByHandle("starScroll").scrollTop(!0)}}]),app.controller("viewCtrl",["$timeout","Toast","$state","$localStorage","$scope","Api","$ionicScrollDelegate","$sce",function(o,e,t,n,r,c,s,i){r.$on("$ionicView.enter",function(e){r.page=0,r.isBtnTop=!1,r.has_more=!0,r.videos=[],r.video=n.video,r.allVideo(r.page),r.video_src=i.trustAsResourceUrl(r.video.embedded_url),console.log("view","$ionicView.enter")}),r.$on("$ionicView.beforeLeave",function(e){r.video_src=void 0,console.log("view","$ionicView.beforeLeave")}),r.allVideo=function(e,t,o){var n=e||"mv",i=t||1;1==i&&(r.searchKey="",r.page=1,r.videos=[],s.$getByHandle("listScroll").scrollTop(!0));var a=o||15;c.get("videos/"+i+"?o="+n+"&limit="+a).then(function(e){e.success&&(r.has_more=e.response.has_more,r.videos=r.videos.concat(e.response.videos),r.$broadcast("scroll.infiniteScrollComplete"))})},r.loadNextPage=function(){r.page++,r.allVideo("",r.page)},r.scroll=function(){1e3<s.$getByHandle("viewScroll").getScrollPosition().top?o(function(){r.isBtnTop=!0},600):o(function(){r.isBtnTop=!1},600),r.isBtnTop=!0},r.scrollTop=function(e){var t=e.target;t.classList?t.classList.add("activated"):t.className+=" activated",o(function(){t.classList?t.classList.remove("activated"):t.className=t.className.replace("activated","")},600),s.$getByHandle("viewScroll").scrollTop(!0)}}]);
//# sourceMappingURL=main.min.js.map
