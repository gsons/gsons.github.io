<extend name="Tpl:Base"/>
<block name="body">
    <!-- Main content -->
    <section class="content">
        <a href="#" class="ion-reply history-back" onclick="history.back(1)">&nbsp;返回</a>
        <div class="nav-tabs-custom">
            <form action="" id="form">
                <div class="box box-success">
                    <div class="box-header with-border">
                        <h3 class="box-title">菜单增加/修改</h3>
                    </div>
                    <div class="box-body">
                        <div class="form-group">
                            <label><span class="text-red">*</span> 所属模块：</label>
                            <select name="module" class="form-control select2 select2-hidden-accessible"
                                    style="width: 100%;" tabindex="-1" aria-hidden="true">
                                <option value="">选择所属模块</option>
                                <option value="Sky" <eq name="info.module" value="Sky" > selected </eq> >Sky</option>
                                <option value="Open" <eq name="info.module" value="Open" > selected </eq> >Open</option>
                            </select>
                        </div>
                        <br>
                        <div class="form-group">
                            <label><span class="text-red">*</span> 父级菜单：</label>
                            <select name="pid" class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true">
                                <option value="">无</option>
                                <volist name="Skymenu" id="vo">
                                    <option value="{$vo.id}" <eq name="info.pid" value="$vo.id" > selected </eq> >{$vo.name}</option>
                                </volist>
                            </select>
                        </div>
                        <br>
                        <div class="form-group">
                            <label><span class="text-red">*</span> 名称：</label>
                            <input type="text" class="form-control" placeholder="名称" name="name"
                                   value="{$info.name}">
                        </div>
                        <br>
                        <div class="form-group">
                            </label>
                            <input type="text" class="form-control" placeholder="分组" name="group"
                                   value="{$info.group}">
                        </div>
                        <br>
                        <div class="form-group">
                            <label>选择图标：</label>
                            <div class="row">
                                <div class="col-xs-1" style="text-align:center;font-size:24px;"><i id="icon-preview" <empty name="info.icon">class="ion-ionic" <else/>class="{$info.icon}"</empty>></i></div>
                                <div class="col-xs-2"><button type="button" class="btn btn-default" onclick="SelectIcon();">点击选择图标</button></div>
                            </div>
                            <input type="hidden" name="icon" value="{$info.icon|default='fa-circle'}" />
                        </div>
                        <br>
                        <div class="form-group">
                            <label>链接：</label>
                            <input type="text" class="form-control" placeholder="链接" name="src"
                                   value="{$info.src}">
                        </div>
                        <br>
                        <div class="form-group">
                            <label>参数：</label>
                            <textarea name="ext" class="form-control">{$info.ext}</textarea>
                        </div>
                        <br>
                        <div class="form-group">
                            <label>显示：</label>
                            <input type="radio" class="form-control" name="usage" value="1" <notempty name="info.usage"><eq name="info.usage" value="1">checked</eq> <else/> checked </notempty> /> 显示 &nbsp;
                            <input type="radio" class="form-control" name="usage" value="0" <eq name="info.usage" value="0">checked</eq> /> 隐藏
                        </div>
                        <br>
                        <div class="form-group">
                            <label>排序：</label>
                            <input type="text" class="form-control" placeholder="排序" name="sort"
                                   value="{$info.sort}">
                        </div>
                        <br>

                    </div>
                    <!-- /.box-body -->
                    <div class="box-footer">
                        <input type="hidden" name="id" value="{:I('get.id')}" />
                        <button type="submit" class="btn btn-primary ajax-submit ajax-post" data-form="form">提交</button>
                    </div>
                </div>
            </form>

        </div>

    </section>
    <!-- /.content -->

</block>
<block name="script">
    <script>
        $('select[name=module]').change(function(){
            $.ajax({
                url: '',
                data: { module:$(this).val() },
                success: function(data){
                    $('select[name=pid]').html('<option value="">无</option>');
                    for(var i in data){
                        $('select[name=pid]').append('<option value="'+data[i].id+'">'+data[i].name+'</option>')
                    }
                    $(".select2").select2();
                }
            })
        })
    </script>
</block>