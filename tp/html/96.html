<!DOCTYPE HTML>
<html lang="zh-CN">
	<head>
		<meta charset="GB2312">
		<title>模型分层</title>
		<link rel="stylesheet" href="../images/css/book.css">
		<link rel="stylesheet" href="../images/prettify/prettify.css">
		<script type="text/javascript" src="../images/js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="../images/prettify/prettify.js"></script>
		<script type="text/javascript">
			$(function(){	
				$(window).resize(function(){
					$('.book-content').css('min-height', $(window).height() - 130);
				}).resize();
				
				var $code = $(".book-content pre");
				$code.each(function(){
					var $this = $(this), $code = $this.children("code"), lang = $code.attr("class");
					$this.addClass("prettyprint linenums");
					lang && $this.addClass("lang-" + lang);					
				});
				
				//调用高亮插件，高亮代码
				prettyPrint();
				
				//解决表格存在边距的问题
				$("table").attr({"cellspacing":"0", "cellpadding":"0"});
				
				//快捷键翻页
				$(document).keydown(function(event){
					if(event.keyCode == 37){ //上一页
						$(".book-title .prev span").click();
					} else if(event.keyCode == 39) {//下一页
						$(".book-title .next span").click();
					}
				});
				
			});
		</script>
	</head>
	<body>
		<div class="book-title">
			<h1>模型分层</h1>
            <div class="page"><a title="上一页" class="prev" href="95.html"><span>上一页</span></a><a title="下一页" class="next" href="97.html"><span>下一页</span></a></div>
            <div class="description"></div>
		</div>
		<div class="book-content"><p>ThinkPHP支持模型的分层 ，除了Model层之外，我们可以项目的需要设计和创建其他的模型层。</p>

<p>通常情况下，不同的分层模型仍然是继承系统的\Think\Model类或其子类，所以，其基本操作和Model类的操作是一致的。</p>

<p>例如在Home模块的设计中需要区分数据层、逻辑层、服务层等不同的模型层，我们可以在模块目录下面创建<code>Model</code>、<code>Logic</code>和<code>Service</code>目录，把对用户表的所有模型操作分成三层：</p>

<ul>
<li>数据层：Home\Model\UserModel 用于定义数据相关的自动验证和自动完成和数据存取接口  </li>
<li>逻辑层：Home\Logic\UserLogic 用于定义用户相关的业务逻辑  </li>
<li>服务层：Home\Service\UserService 用于定义用户相关的服务接口等  </li>
</ul>

<p>三个模型层的定义如下：</p>

<p>Model类：Home\Model\UserModel.class.php</p>

<pre><code>namespace Home\Model;
class UserModel extends \Think\Model{

}
</code></pre>

<p>实例化方法：<code>D('User');</code></p>

<p>Logic类：Home\Logic\UserLogic.class.php</p>

<pre><code>namespace Home\Logic;
class UserLogic extends \Think\Model{

}
</code></pre>

<p>实例化方法：<code>D('User','Logic');</code></p>

<p>Api类：Home\Api\UserApi.class.php</p>

<pre><code>namespace Home\Api;
class UserApi extends \Think\Model{

}
</code></pre>

<p>实例化方法：<code>D('User','Api');</code></p>

<p>D方法默认操作的模型层由<code>DEFAULT_M_LAYER</code>参数配置，我们可以改变默认操作的模型层为Logic层，例如：</p>

<pre><code>'DEFAULT_M_LAYER'       =&gt;  'Logic', // 默认的模型层名称
</code></pre>

<p>这样，当我们调用：</p>

<pre><code>$User = D('User');
</code></pre>

<p>的时候其实是实例化的 <code>UserLogic</code>类，而不是<code>UserModel</code>类。</p>
</div>
		<div class="book-footer">
			<div class="page"><a title="上一页" class="prev" href="95.html"><span>上一页</span></a><a title="下一页" class="next" href="97.html"><span>下一页</span></a></div>
		</div>
	</body>
</html>
