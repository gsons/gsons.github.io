<!DOCTYPE HTML>
<html lang="zh-CN">
	<head>
		<meta charset="GB2312">
		<title>入口文件</title>
		<link rel="stylesheet" href="../images/css/book.css">
		<link rel="stylesheet" href="../images/prettify/prettify.css">
		<script type="text/javascript" src="../images/js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="../images/prettify/prettify.js"></script>
		<script type="text/javascript">
			$(function(){	
				$(window).resize(function(){
					$('.book-content').css('min-height', $(window).height() - 130);
				}).resize();
				
				var $code = $(".book-content pre");
				$code.each(function(){
					var $this = $(this), $code = $this.children("code"), lang = $code.attr("class");
					$this.addClass("prettyprint linenums");
					lang && $this.addClass("lang-" + lang);					
				});
				
				//调用高亮插件，高亮代码
				prettyPrint();
				
				//解决表格存在边距的问题
				$("table").attr({"cellspacing":"0", "cellpadding":"0"});
				
				//快捷键翻页
				$(document).keydown(function(event){
					if(event.keyCode == 37){ //上一页
						$(".book-title .prev span").click();
					} else if(event.keyCode == 39) {//下一页
						$(".book-title .next span").click();
					}
				});
				
			});
		</script>
	</head>
	<body>
		<div class="book-title">
			<h1>入口文件</h1>
            <div class="page"><a title="上一页" class="prev" href="4.html"><span>上一页</span></a><a title="下一页" class="next" href="6.html"><span>下一页</span></a></div>
            <div class="description"></div>
		</div>
		<div class="book-content"><p>ThinkPHP采用<strong>单一入口模式</strong>进行项目部署和访问，无论完成什么功能，一个应用都有一个统一（但不一定是唯一）的入口。</p>

<p>应该说，所有应用都是从入口文件开始的，并且不同应用的入口文件是类似的。</p>

<h2>入口文件定义</h2>

<p>入口文件主要完成：</p>

<ul>
<li>定义框架路径、项目路径（可选）</li>
<li>定义调试模式和应用模式（可选）</li>
<li>定义系统相关常量（可选）</li>
<li>载入框架入口文件（必须）</li>
</ul>

<p>默认情况下，3.2版本的框架已经自带了一个应用入口文件（以及默认的目录结构），内容如下：</p>

<pre><code>define('APP_PATH','./Application/');
require './ThinkPHP/ThinkPHP.php';
</code></pre>

<blockquote>
  <p>注意：3.2版本开始无需定义APP_NAME常量</p>
</blockquote>

<p>如果你改变了项目目录（例如把<code>Application</code>更改为<code>Apps</code>），只需要在入口文件更改<strong>APP_PATH</strong>常量定义即可：</p>

<pre><code>define('APP_PATH','./Apps/');
require './ThinkPHP/ThinkPHP.php';
</code></pre>

<blockquote>
  <p>注意：APP_PATH的定义支持相对路径和绝对路径，但必须以“/”结束</p>
</blockquote>

<p>如果你调整了框架核心目录的位置或者目录名，只需要这样修改：</p>

<pre><code>define('APP_PATH','./Application/');
require './Think/ThinkPHP.php';
</code></pre>

<p>也可以单独定义一个<strong>THINK_PATH</strong>常量用于引入：</p>

<pre><code>define('APP_PATH','./Application/');
define('THINK_PATH',realpath('../Think').'/');
require THINK_PATH.'ThinkPHP.php';
</code></pre>

<blockquote>
  <p>和APP_PATH一样THINK_PATH路径定义也必须以“/”结尾。<br />
  给THINK_PATH和APP_PATH定义绝对路径会提高系统的加载效率。</p>
</blockquote>

<h2>入口文件中的其他定义</h2>

<p>一般不建议在入口文件中做过多的操作，但可以重新定义一些系统常量，入口文件中支持定义（建议）的一些系统常量包括：</p>

<table>
<thead>
<tr>
  <th>常量</th>
  <th>描述</th>
</tr>
</thead>
<tbody>
<tr>
  <td>THINK_PATH</td>
  <td>框架目录</td>
</tr>
<tr>
  <td>APP_PATH</td>
  <td>应用目录</td>
</tr>
<tr>
  <td>RUNTIME_PATH</td>
  <td>应用运行时目录（可写）</td>
</tr>
<tr>
  <td>APP_DEBUG</td>
  <td>应用调试模式 （默认为false）</td>
</tr>
<tr>
  <td>STORAGE_TYPE</td>
  <td>存储类型（默认为File）</td>
</tr>
<tr>
  <td>APP_MODE</td>
  <td>应用模式（默认为common）</td>
</tr>
</tbody>
</table>

<blockquote>
  <p>注意：所有路径常量都必须以“/”结尾</p>
</blockquote>

<p>例如，我们可以在入口文件中重新定义相关目录并且开启调试模式：</p>

<pre><code>// 定义应用目录
define('APP_PATH','./Apps/');
// 定义运行时目录
define('RUNTIME_PATH','./Runtime/');
// 开启调试模式
define('APP_DEBUG',True);
// 更名框架目录名称，并载入框架入口文件
require './Think/ThinkPHP.php';
</code></pre>

<p>这样最终的应用目录结构如下：</p>

<pre><code>www  WEB部署目录（或者子目录）
├─index.php       应用入口文件
├─Apps            应用目录
├─Public          资源文件目录
├─Runtime         运行时目录
└─Think           框架目录
</code></pre>

<blockquote>
  <p>入口文件中还可以定义一些系统变量，用于相关的绑定操作（通常用于多个入口的情况），这个会在后面涉及，暂且不提。</p>
</blockquote>
</div>
		<div class="book-footer">
			<div class="page"><a title="上一页" class="prev" href="4.html"><span>上一页</span></a><a title="下一页" class="next" href="6.html"><span>下一页</span></a></div>
		</div>
	</body>
</html>
