<!DOCTYPE HTML>
<html lang="zh-CN">
	<head>
		<meta charset="GB2312">
		<title>FIELD</title>
		<link rel="stylesheet" href="../images/css/book.css">
		<link rel="stylesheet" href="../images/prettify/prettify.css">
		<script type="text/javascript" src="../images/js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="../images/prettify/prettify.js"></script>
		<script type="text/javascript">
			$(function(){	
				$(window).resize(function(){
					$('.book-content').css('min-height', $(window).height() - 130);
				}).resize();
				
				var $code = $(".book-content pre");
				$code.each(function(){
					var $this = $(this), $code = $this.children("code"), lang = $code.attr("class");
					$this.addClass("prettyprint linenums");
					lang && $this.addClass("lang-" + lang);					
				});
				
				//调用高亮插件，高亮代码
				prettyPrint();
				
				//解决表格存在边距的问题
				$("table").attr({"cellspacing":"0", "cellpadding":"0"});
				
				//快捷键翻页
				$(document).keydown(function(event){
					if(event.keyCode == 37){ //上一页
						$(".book-title .prev span").click();
					} else if(event.keyCode == 39) {//下一页
						$(".book-title .next span").click();
					}
				});
				
			});
		</script>
	</head>
	<body>
		<div class="book-title">
			<h1>FIELD</h1>
            <div class="page"><a title="上一页" class="prev" href="59.html"><span>上一页</span></a><a title="下一页" class="next" href="61.html"><span>下一页</span></a></div>
            <div class="description"></div>
		</div>
		<div class="book-content"><p>field方法属于模型的连贯操作方法之一，主要目的是标识要返回或者操作的字段，可以用于查询和写入操作。</p>

<h2>1、用于查询</h2>

<h5>指定字段</h5>

<p>在查询操作中field方法是使用最频繁的。</p>

<pre><code>$Model-&gt;field('id,title,content')-&gt;select();
</code></pre>

<p>这里使用field方法指定了查询的结果集中包含id,title,content三个字段的值。执行的SQL相当于：</p>

<pre><code>SELECT id,title,content FROM table
</code></pre>

<p>可以给某个字段设置别名，例如：</p>

<pre><code>$Model-&gt;field('id,nickname as name')-&gt;select();
</code></pre>

<p>执行的SQL语句相当于：</p>

<pre><code>SELECT id,nickname as name FROM table
</code></pre>

<h5>使用SQL函数</h5>

<p>可以在field方法中直接使用函数，例如：</p>

<pre><code>$Model-&gt;field('id,SUM(score)')-&gt;select();
</code></pre>

<p>执行的SQL相当于：</p>

<pre><code>SELECT id,SUM(score) FROM table
</code></pre>

<p>当然，除了select方法之外，所有的查询方法，包括find等都可以使用field方法，这里只是以select为例说明。</p>

<h5>使用数组参数</h5>

<p>field方法的参数可以支持数组，例如：</p>

<pre><code>$Model-&gt;field(array('id','title','content'))-&gt;select();
</code></pre>

<p>最终执行的SQL和前面用字符串方式是等效的。</p>

<p>数组方式的定义可以为某些字段定义别名，例如：</p>

<pre><code>$Model-&gt;field(array('id','nickname'=&gt;'name'))-&gt;select();
</code></pre>

<p>执行的SQL相当于：</p>

<pre><code>SELECT id,nickname as name FROM table
</code></pre>

<p>对于一些更复杂的字段要求，数组的优势则更加明显，例如：</p>

<pre><code>$Model-&gt;field(array('id','concat(name,'-',id)'=&gt;'truename','LEFT(title,7)'=&gt;'sub_title'))-&gt;select();
</code></pre>

<p>执行的SQL相当于：</p>

<pre><code>SELECT id,concat(name,'-',id) as truename,LEFT(title,7) as sub_title FROM table
</code></pre>

<h5>获取所有字段</h5>

<p>如果有一个表有非常多的字段，需要获取所有的字段（这个也许很简单，因为不调用field方法或者直接使用空的field方法都能做到）：</p>

<pre><code>$Model-&gt;select();
$Model-&gt;field()-&gt;select();
$Model-&gt;field('*')-&gt;select();
</code></pre>

<p>上面三个用法是等效的，都相当于执行SQL：</p>

<pre><code>SELECT * FROM table
</code></pre>

<p>但是这并不是我说的获取所有字段，我希望显式的调用所有字段（对于对性能要求比较高的系统，这个要求并不过分，起码是一个比较好的习惯），那么OK，仍然很简单，下面的用法可以完成预期的作用：</p>

<pre><code>$Model-&gt;field(true)-&gt;select();
</code></pre>

<p><code>fied(true)</code>的用法会显式的获取数据表的所有字段列表，哪怕你的数据表有100个字段。</p>

<h5>字段排除</h5>

<p>如果我希望获取排除数据表中的<code>content</code>字段（文本字段的值非常耗内存）之外的所有字段值，我们就可以使用field方法的排除功能，例如下面的方式就可以实现所说的功能：</p>

<pre><code>$Model-&gt;field('content',true)-&gt;select();
</code></pre>

<p>则表示获取除了content之外的所有字段，要排除更多的字段也可以：</p>

<pre><code>$Model-&gt;field('user_id,content',true)-&gt;select();
//或者用
$Model-&gt;field(array('user_id','content'),true)-&gt;select();
</code></pre>

<h2>2、用于写入</h2>

<p>除了查询操作之外，field方法还有一个非常重要的安全功能--字段合法性检测（注意：该功能3.1版本开始才能支持）。field方法结合create方法使用就可以完成表单提交的字段合法性检测，如果我们在表单提交的处理方法中使用了：</p>

<pre><code>$Model-&gt;field('title,email,content')-&gt;create();
</code></pre>

<p>即表示表单中的合法字段只有<code>title</code>,<code>email</code>和<code>content</code>字段，无论用户通过什么手段更改或者添加了浏览器的提交字段，都会直接屏蔽。因为，其他是所有字段我们都不希望由用户提交来决定，你可以通过自动完成功能定义额外的字段写入。</p>
</div>
		<div class="book-footer">
			<div class="page"><a title="上一页" class="prev" href="59.html"><span>上一页</span></a><a title="下一页" class="next" href="61.html"><span>下一页</span></a></div>
		</div>
	</body>
</html>
